<!DOCTYPE html>
<html>
	<head>
		<script type="text/javascript">
		alert("onload 1");
		function unescapeHtml(escaped_str) {
		    var div = document.createElement('div');
		    div.innerHTML = escaped_str;
		    var child = div.childNodes[0];
		    return child ? child.nodeValue : null;
		}
		
		function validateProtocol(url) {
			var parser = document.createElement('a');
		    parser.href = url;
		    var protocol = parser.protocol.toLowerCase();
			if ([ 'javascript:',  'vbscript:',  'data:', 'ftp:',':' , ' '].indexOf(protocol) < 0) {
				return url;
			}
			return null;
		}
		
		function validate(url) {
			var unescaped_value = unescapeHtml(url);
			if (unescaped_value && validateProtocol(unescaped_value)) {
				return unescaped_value;
			}
			return '/';
		}
			window.onload = function() {
				alert("onload");
				var a = "open?link_click_id=700042400868501507";
				var b = "funnyquote://";

				var fallbackFunction = function() {
					if (document.webkitHidden || document.hidden) { return; }
					alert("fallback");
					window.top.location.replace(validate("market://details?id=com.justfun.funnyquotes"));
				};
				var addIFrame = function() {
					var iframe = document.createElement("iframe");
					iframe.style.border = "none";
					iframe.style.width = "1px";
					iframe.style.height = "1px";
					iframe.src = validate(b + a);
					document.body.appendChild(iframe);
				};
				if ((navigator.userAgent.match(/Chrome/) && navigator.userAgent.match("Version/")) ||
						navigator.userAgent.match("\\[FB") ||
						navigator.userAgent.match("Instagram")) {
					var setURIFunction = function() {
						addIFrame();
						setTimeout(fallbackFunction, 750-250);
					};
					alert("Chrome");
					setTimeout(setURIFunction, 250);
					return;
				}
				else if (navigator.userAgent.match("KAKAO") ||
							navigator.userAgent.match("NAVER") ||
							navigator.userAgent.match("Firefox")) {
					alert("KAKAO");			
					addIFrame();
				}
				else if (!(navigator.userAgent.match("OPR") && !navigator.userAgent.match("Android 8"))) {
					alert("OPR");	
					window.top.location.replace(validate(b + a));
				}
				else if (!(navigator.userAgent.match("OPT"))) {
					alert("OPT");	
					window.top.location.replace(validate(b + a));
				}
				setTimeout(fallbackFunction, 750);

			};


		</script>
	</head>
	<body>
	</body>